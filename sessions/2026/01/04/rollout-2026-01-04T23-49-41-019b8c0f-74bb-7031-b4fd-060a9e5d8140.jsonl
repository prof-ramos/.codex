{"timestamp":"2026-01-05T02:49:41.861Z","type":"session_meta","payload":{"id":"019b8c0f-74bb-7031-b4fd-060a9e5d8140","timestamp":"2026-01-05T02:49:41.819Z","cwd":"/Users/gabrielramos/sherlock-discord-bot","originator":"codex_cli_rs","cli_version":"0.77.0","instructions":"# AGENTS.md\n\nDevelopment guidelines for agentic coding agents working on the SherlockRamosBot Discord chatbot.\n\n## Table of Contents\n\n1. [Project Overview](#project-overview)\n2. [Development Commands](#development-commands)\n3. [Code Style Guidelines](#code-style-guidelines)\n4. [Architecture Guidelines](#architecture-guidelines)\n5. [Development Workflow](#development-workflow)\n6. [Bot Personality Guidelines](#bot-personality-guidelines)\n7. [Security & Permissions](#security--permissions)\n8. [Testing Guidelines](#testing-guidelines-future)\n9. [Performance Considerations](#performance-considerations)\n10. [Deployment Notes](#deployment-notes)\n11. [Extending the Bot](#extending-the-bot)\n\n## Project Overview\n\nSherlockRamosBot is a Python Discord chatbot for Brazilian law students (concurseiros) that uses\nOpenRouter API to provide access to multiple LLM models. The bot maintains contextual conversations\nin Discord threads and is designed for answering legal questions in Portuguese.\n\n## Development Commands\n\n### Running the Bot\n\n```bash\n# Recommended way (uses uv package manager)\nuv run sherlock-bot\n\n# Alternative (direct module execution)\nuv run python -m src.main\n\n# Install dependencies\nuv sync\n```\n\n### Testing\n\n```bash\n# No test framework currently configured\n# When adding tests, use: uv run pytest\n# Run single test: uv run pytest tests/test_file.py::test_function\n```\n\n### Code Quality (TO BE ADDED)\n\n```bash\n# Code formatting (when configured)\nuv run black src/\nuv run ruff format src/\n\n# Linting (when configured)\nuv run ruff check src/\nuv run flake8 src/\n\n# Type checking (when configured)\nuv run pyright src/\n```\n\n## Code Style Guidelines\n\n### Import Organization\n\n**Order**: Standard library ‚Üí Third-party ‚Üí Local imports\n\n```python\n# Standard library\nfrom collections import defaultdict\nfrom typing import Optional, List\nimport os\nimport asyncio\n\n# Third-party\nimport discord\nfrom discord import Message as DiscordMessage, app_commands\nimport yaml\nimport dacite\n\n# Local imports\nfrom src.base import Message, Conversation, ThreadConfig\nfrom src.constants import BOT_NAME, DEFAULT_MODEL\nfrom src.utils import logger, should_block\n```\n\n### Type Hints Requirements\n\n- **Mandatory**: All functions must have type hints for parameters and return values\n- **Use Optional** for nullable values: `Optional[str]`\n- **Use Literal** for string constants: `Literal[\"openai/gpt-3.5-turbo\", \"anthropic/claude-3-opus\"]`\n- **Use Final** for constants: `Final[str]`, `Final[List[int]]`\n- **Prefer specific types** over generics when possible\n\n### Naming Conventions\n\n- **Variables/Functions**: `snake_case`\n- **Classes/Enums**: `PascalCase`\n- **Constants**: `UPPER_CASE_WITH_UNDERSCORES`\n- **Descriptive names**: `discord_message_to_message` (not `convert_msg`)\n- **Consistent prefixes**: `BOT_`, `SERVER_TO_`, `MY_BOT_`\n\n### Error Handling Patterns\n\n```python\n# Use custom exception hierarchy from src.exceptions\nfrom src.exceptions import SherlockBotError, ConfigError, OpenRouterError\n\n# Structured error handling with specific catches\ntry:\n    result = await some_operation()\nexcept OpenRouterError as e:\n    logger.exception(\"OpenRouter API error\")\n    await send_error_message(ctx, f\"API Error: {e}\")\nexcept ConfigError as e:\n    logger.exception(\"Configuration error\")\n    await send_error_message(ctx, f\"Configuration Error: {e}\")\nexcept Exception as e:\n    logger.exception(\"Unexpected error\")\n    await send_error_message(ctx, \"An unexpected error occurred\")\n```\n\n### Async/Await Patterns\n\n- **All Discord operations must be async**\n- **Use proper async context managers**: `async with thread.typing():`\n- **Chain async calls properly**: `result = await func1(await func2())`\n- **Handle async errors with try/except blocks**\n\n### Discord.py Specific Patterns\n\n```python\n# Type aliases for Discord objects\nfrom discord import Message as DiscordMessage, Guild as DiscordGuild\n\n# Command decorators with permission checks\n@tree.command(\n    name=\"chat\",\n    description=\"Inicia uma conversa com o bot\",\n    guild=discord.Object(id=guild_id)\n)\n@app_commands.describe(message=\"Sua pergunta ou d√∫vida\")\nasync def chat_command(\n    interaction: discord.Interaction,\n    message: str,\n    temperature: Optional[float] = 1.0\n) -> None:\n    # Implementation\n```\n\n### Data Structures\n\n```python\n# Use dataclasses for structured data\n@dataclass(frozen=True)\nclass Message:\n    user: str\n    text: Optional[str] = None\n\n# Use enums for status codes and constants\nclass CompletionResult(Enum):\n    SUCCESS = \"success\"\n    TOO_LONG = \"too_long\"\n    INVALID_REQUEST = \"invalid_request\"\n    OTHER_ERROR = \"other_error\"\n```\n\n### Configuration Management\n\n- **Environment variables**: Use `get_env()` from `src.constants`\n- **YAML config**: Bot personality in `src/config.yaml`\n- **Type-safe config**: Use dacite with dataclasses for YAML parsing\n- **Validation**: Raise `ConfigError` for missing required variables\n\n### Logging Patterns\n\n```python\n# Use logger from src.utils\nfrom src.utils import logger\n\n# Structured logging with context\nlogger.info(\"Processing message\", extra={\n    \"user_id\": interaction.user.id,\n    \"channel_id\": interaction.channel.id,\n    \"message_length\": len(message)\n})\n\n# Exception logging with full traceback\nlogger.exception(\"Error processing completion\")\n```\n\n### Documentation Standards\n\n- **Docstrings**: All public functions must have docstrings\n- **Type hints**: Serve as documentation - make them descriptive\n- **Inline comments**: Use for complex logic, especially Portuguese legal concepts\n- **TODO markers**: Use for future improvements with specific context\n\n### File Organization\n\n```\nsrc/\n‚îú‚îÄ‚îÄ main.py          # Entry point, Discord events, slash commands\n‚îú‚îÄ‚îÄ base.py          # Core data structures (Message, Conversation, etc.)\n‚îú‚îÄ‚îÄ completion.py    # LLM API interaction and response handling\n‚îú‚îÄ‚îÄ constants.py     # Configuration loading, environment variables\n‚îú‚îÄ‚îÄ utils.py         # Helper utilities, Discord operations\n‚îú‚îÄ‚îÄ moderation.py    # Content moderation (currently disabled)\n‚îú‚îÄ‚îÄ exceptions.py    # Custom exception hierarchy\n‚îî‚îÄ‚îÄ config.yaml      # Bot personality and example conversations\n```\n\n## Architecture Guidelines\n\n### Thread-Based Conversations\n\n- **Create threads** for each conversation via `/chat` command\n- **Maintain context** using `thread_data` defaultdict with `ThreadConfig`\n- **Message limits**: Respect `MAX_THREAD_MESSAGES` (200) and token limits\n- **Thread lifecycle**: Use `ACTIVATE_THREAD_PREFIX` (üí¨‚úÖ) and `INACTIVATE_THREAD_PREFIX` (üí¨‚ùå)\n\n### OpenRouter Integration\n\n- **Base URL**: Must be `https://openrouter.ai/api/v1`\n- **API key format**: `sk-or-v1-...`\n- **Custom headers**: Required `HTTP-Referer` and `X-Title`\n- **Model selection**: Use `AVAILABLE_MODELS` literal type for type safety\n\n### Error Recovery\n\n- **Graceful degradation**: Always provide user-friendly error messages\n- **Thread state**: Don't leave threads in broken state\n- **Retry logic**: Implement for transient API errors\n- **Logging**: Log all errors with context for debugging\n\n## Development Workflow\n\n### Environment Setup\n\n1. Copy `.env.example` to `.env` and configure variables\n2. Run `uv sync` to install dependencies\n3. Ensure Python 3.13+ is installed\n4. Configure Discord bot with proper intents (Message Content Intent required)\n\n### Making Changes\n\n1. **Understand existing patterns** before modifying code\n2. **Follow type hints** and error handling patterns\n3. **Test Discord interactions** carefully (threads, permissions)\n4. **Update configuration** if adding new models or features\n5. **Log changes** appropriately for debugging\n\n### Common Pitfalls\n\n- **Missing Message Content Intent**: Bot won't receive message content\n- **Thread state loss on restart**: `thread_data` is in-memory only\n- **OpenRouter headers**: Required for API requests\n- **Server allowlist**: Only `ALLOWED_SERVER_IDS` can use bot\n- **Async context**: All Discord operations must be async\n\n## Bot Personality Guidelines\n\n### Legal Focus\n\n- **Brazilian law**: Specialize in Brazilian legal topics\n- **Concurseiros**: Target audience studying for public exams\n- **Portuguese language**: All responses in Portuguese\n- **Professional tone**: Maintain helpful, educational tone\n\n### Response Patterns\n\n- **Structured answers**: Use clear organization for legal concepts\n- **Examples provided**: Include practical examples when helpful\n- **Citations**: Reference laws, articles, and jurisprudence when applicable\n- **Study focus**: Emphasize exam-relevant information\n\n## Security & Permissions\n\n### Required Discord Permissions\n\n- Send Messages\n- Send Messages in Threads\n- Create Public Threads\n- Manage Messages (moderation)\n- Manage Threads\n- Read Message History\n- Use Slash Commands\n\n### Security Considerations\n\n- **Server allowlist**: Enforce `ALLOWED_SERVER_IDS`\n- **API key security**: Never commit API keys to repository\n- **Input validation**: Validate user inputs appropriately\n- **Rate limiting**: Respect API rate limits\n\n## Testing Guidelines (Future)\n\n### When Adding Tests\n\n- **Use pytest**: Framework of choice for Python testing\n- **Mock Discord**: Use pytest-discord or similar for Discord.py testing\n- **Test async functions**: Use pytest-asyncio for async test functions\n- **Configuration testing**: Test config loading and validation\n- **Error scenarios**: Test error handling and recovery\n\n### Test Structure\n\n```\ntests/\n‚îú‚îÄ‚îÄ test_main.py           # Discord event handlers\n‚îú‚îÄ‚îÄ test_completion.py     # OpenRouter API integration\n‚îú‚îÄ‚îÄ test_base.py          # Data structures\n‚îú‚îÄ‚îÄ test_constants.py     # Configuration loading\n‚îú‚îÄ‚îÄ test_utils.py         # Helper utilities\n‚îî‚îÄ‚îÄ conftest.py           # Test fixtures and configuration\n```\n\n## Performance Considerations\n\n### Memory Management\n\n- **Thread limits**: Respect `MAX_THREAD_MESSAGES` to prevent memory bloat\n- **Generator patterns**: Use generators for large data processing\n- **Context cleanup**: Clean up thread data when threads close\n\n### API Optimization\n\n- **Batch operations**: Batch Discord operations when possible\n- **Caching**: Cache frequently accessed configuration\n- **Rate limiting**: Implement appropriate rate limiting for API calls\n\n## Deployment Notes\n\n### Environment Variables\n\n- **Required**: `OPENROUTER_API_KEY`, `DISCORD_BOT_TOKEN`, `DISCORD_CLIENT_ID`\n- **Optional**: `ALLOWED_SERVER_IDS`, `SERVER_TO_MODERATION_CHANNEL`, `DEFAULT_MODEL`\n- **Validation**: Use `get_env()` with `required=True` for critical variables\n\n### Production Considerations\n\n- **Logging**: Configure appropriate log levels for production\n- **Error monitoring**: Consider adding error monitoring service\n- **Resource limits**: Monitor memory and API usage\n- **Backup strategy**: Thread state is lost on restart\n\n## Extending the Bot\n\n### Adding a New Slash Command\n\nTo add a new slash command, define it in `src/main.py`:\n\n```python\n@tree.command(\n    name=\"jurisprudencia\",\n    description=\"Busca jurisprud√™ncia no banco de dados\",\n    guild=discord.Object(id=guild_id)\n)\n@app_commands.describe(termo=\"Termo para busca\")\nasync def jurisprudencia_command(interaction: discord.Interaction, termo: str):\n    await interaction.response.defer()\n    # L√≥gica de busca...\n    results = await search_jurisprudence(termo)\n    await interaction.followup.send(f\"Resultados para {termo}: ...\")\n```\n\n### Adding a New RAG Source\n\nTo ingest a new type of document, create a handler in `scripts/ingest_docs.py`:\n\n```python\ndef extract_text_from_html(file_path: Path) -> str:\n    # Use BeautifulSoup or similar\n    ...\n```\n\n\n## Skills\nThese skills are discovered at startup from multiple local sources. Each entry includes a name, description, and file path so you can open the source for full instructions.\n- architecture-diagram-creator: Create comprehensive HTML architecture diagrams showing data flows, business objectives, features, technical architecture, and deployment. Use when users request system architecture, project documentation, high-level overviews, or technical specifications. (file: /Users/gabrielramos/.codex/skills/architecture-diagram-creator/SKILL.md)\n- article-extractor: Extract clean article content from URLs (blog posts, articles, tutorials) and save as readable text. Use when user wants to download, extract, or save an article/blog post from a URL without ads, navigation, or clutter. (file: /Users/gabrielramos/.codex/skills/article-extractor/SKILL.md)\n- artifacts-builder: Suite of tools for creating elaborate, multi-component claude.ai HTML artifacts using modern frontend web technologies (React, Tailwind CSS, shadcn/ui). Use for complex artifacts requiring state management, routing, or shadcn/ui components - not for simple single-file HTML/JSX artifacts. (file: /Users/gabrielramos/.codex/skills/artifacts-builder/SKILL.md)\n- aws-agentic-ai: AWS Bedrock AgentCore comprehensive expert for deploying and managing all AgentCore services. Use when working with Gateway, Runtime, Memory, Identity, or any AgentCore component. Covers MCP target deployment, credential management, schema optimization, runtime configuration, memory management, and identity services. (file: /Users/gabrielramos/.codex/skills/aws-agentic-ai/SKILL.md)\n- aws-cdk-development: AWS Cloud Development Kit (CDK) expert for building cloud infrastructure with TypeScript/Python. Use when creating CDK stacks, defining CDK constructs, implementing infrastructure as code, or when the user mentions CDK, CloudFormation, IaC, cdk synth, cdk deploy, or wants to define AWS infrastructure programmatically. Covers CDK app structure, construct patterns, stack composition, and deployment workflows. (file: /Users/gabrielramos/.codex/skills/aws-cdk-development/SKILL.md)\n- aws-cost-operations: This skill provides AWS cost optimization, monitoring, and operational best practices with integrated MCP servers for billing analysis, cost estimation, observability, and security assessment. (file: /Users/gabrielramos/.codex/skills/aws-cost-operations/SKILL.md)\n- aws-serverless-eda: AWS serverless and event-driven architecture expert based on Well-Architected Framework. Use when building serverless APIs, Lambda functions, REST APIs, microservices, or async workflows. Covers Lambda with TypeScript/Python, API Gateway (REST/HTTP), DynamoDB, Step Functions, EventBridge, SQS, SNS, and serverless patterns. Essential when user mentions serverless, Lambda, API Gateway, event-driven, async processing, queues, pub/sub, or wants to build scalable serverless applications with AWS best practices. (file: /Users/gabrielramos/.codex/skills/aws-serverless-eda/SKILL.md)\n- brainstorming: You MUST use this before any creative work - creating features, building components, adding functionality, or modifying behavior. Explores user intent, requirements and design before implementation. (file: /Users/gabrielramos/.codex/skills/brainstorming/SKILL.md)\n- brand-guidelines: Applies Anthropic's official brand colors and typography to any sort of artifact that may benefit from having Anthropic's look-and-feel. Use it when brand colors or style guidelines, visual formatting, or company design standards apply. (file: /Users/gabrielramos/.codex/skills/brand-guidelines/SKILL.md)\n- canvas-design: Create beautiful visual art in .png and .pdf documents using design philosophy. You should use this skill when the user asks to create a poster, piece of art, design, or other static piece. Create original visual designs, never copying existing artists' work to avoid copyright violations. (file: /Users/gabrielramos/.codex/skills/canvas-design/SKILL.md)\n- changelog-generator: Automatically creates user-facing changelogs from git commits by analyzing commit history, categorizing changes, and transforming technical commits into clear, customer-friendly release notes. Turns hours of manual changelog writing into minutes of automated generation. (file: /Users/gabrielramos/.codex/skills/changelog-generator/SKILL.md)\n- code-auditor: Performs comprehensive codebase analysis covering architecture, code quality, security, performance, testing, and maintainability. Use when user wants to audit code quality, identify technical debt, find security issues, assess test coverage, or get a codebase health check. (file: /Users/gabrielramos/.codex/skills/code-auditor/SKILL.md)\n- code-execution: Execute Python code locally with marketplace API access for 90%+ token savings on bulk operations. Activates when user requests bulk operations (10+ files), complex multi-step workflows, iterative processing, or mentions efficiency/performance. (file: /Users/gabrielramos/.codex/skills/code-execution/SKILL.md)\n- code-refactor: Perform bulk code refactoring operations like renaming variables/functions across files, replacing patterns, and updating API calls. Use when users request renaming identifiers, replacing deprecated code patterns, updating method calls, or making consistent changes across multiple locations. (file: /Users/gabrielramos/.codex/skills/code-refactor/SKILL.md)\n- code-transfer: Transfer code between files with line-based precision. Use when users request copying code from one location to another, moving functions or classes between files, extracting code blocks, or inserting code at specific line numbers. (file: /Users/gabrielramos/.codex/skills/code-transfer/SKILL.md)\n- codebase-documenter: Generates comprehensive documentation explaining how a codebase works, including architecture, key components, data flow, and development guidelines. Use when user wants to understand unfamiliar code, create onboarding docs, document architecture, or explain how the system works. (file: /Users/gabrielramos/.codex/skills/codebase-documenter/SKILL.md)\n- competitive-ads-extractor: Extracts and analyzes competitors' ads from ad libraries (Facebook, LinkedIn, etc.) to understand what messaging, problems, and creative approaches are working. Helps inspire and improve your own ad campaigns. (file: /Users/gabrielramos/.codex/skills/competitive-ads-extractor/SKILL.md)\n- content-research-writer: Assists in writing high-quality content by conducting research, adding citations, improving hooks, iterating on outlines, and providing real-time feedback on each section. Transforms your writing process from solo effort to collaborative partnership. (file: /Users/gabrielramos/.codex/skills/content-research-writer/SKILL.md)\n- conversation-analyzer: Analyzes your Claude Code conversation history to identify patterns, common mistakes, and opportunities for workflow improvement. Use when user wants to understand usage patterns, optimize workflow, identify automation opportunities, or check if they're following best practices. (file: /Users/gabrielramos/.codex/skills/conversation-analyzer/SKILL.md)\n- csv-data-summarizer: Analyzes CSV files, generates summary stats, and plots quick visualizations using Python and pandas. (file: /Users/gabrielramos/.codex/skills/csv-data-summarizer-claude-skill/SKILL.md)\n- d3-viz: Creating interactive data visualisations using d3.js. This skill should be used when creating custom charts, graphs, network diagrams, geographic visualisations, or any complex SVG-based data visualisation that requires fine-grained control over visual elements, transitions, or interactions. Use this for bespoke visualisations beyond standard charting libraries, whether in React, Vue, Svelte, vanilla JavaScript, or any other environment. (file: /Users/gabrielramos/.codex/skills/claude-d3js-skill/SKILL.md)\n- dashboard-creator: Create HTML dashboards with KPI metric cards, bar/pie/line charts, progress indicators, and data visualizations. Use when users request dashboards, metrics displays, KPI visualizations, data charts, or monitoring interfaces. (file: /Users/gabrielramos/.codex/skills/dashboard-creator/SKILL.md)\n- developer-growth-analysis: Analyzes your recent Claude Code chat history to identify coding patterns, development gaps, and areas for improvement, curates relevant learning resources from HackerNews, and automatically sends a personalized growth report to your Slack DMs. (file: /Users/gabrielramos/.codex/skills/developer-growth-analysis/SKILL.md)\n- docx: Comprehensive document creation, editing, and analysis with support for tracked changes, comments, formatting preservation, and text extraction. When Claude needs to work with professional documents (.docx files) for: (1) Creating new documents, (2) Modifying or editing content, (3) Working with tracked changes, (4) Adding comments, or any other document tasks (file: /Users/gabrielramos/.codex/skills/docx/SKILL.md)\n- domain-name-brainstormer: Generates creative domain name ideas for your project and checks availability across multiple TLDs (.com, .io, .dev, .ai, etc.). Saves hours of brainstorming and manual checking. (file: /Users/gabrielramos/.codex/skills/domain-name-brainstormer/SKILL.md)\n- family-history-planning: Provides assistance with planning family history and genealogy research projects. (file: /Users/gabrielramos/.codex/skills/claude-family-history-research-skill/SKILL.md)\n- feature-planning: Break down feature requests into detailed, implementable plans with clear tasks. Use when user requests a new feature, enhancement, or complex change. (file: /Users/gabrielramos/.codex/skills/feature-planning/SKILL.md)\n- ffuf-web-fuzzing: Expert guidance for ffuf web fuzzing during penetration testing, including authenticated fuzzing with raw requests, auto-calibration, and result analysis (file: /Users/gabrielramos/.codex/skills/ffuf-skill/SKILL.md)\n- file-operations: Analyze files and get detailed metadata including size, line counts, modification times, and content statistics. Use when users request file information, statistics, or analysis without modifying files. (file: /Users/gabrielramos/.codex/skills/file-operations/SKILL.md)\n- file-organizer: Intelligently organizes your files and folders across your computer by understanding context, finding duplicates, suggesting better structures, and automating cleanup tasks. Reduces cognitive load and keeps your digital workspace tidy without manual effort. (file: /Users/gabrielramos/.codex/skills/file-organizer/SKILL.md)\n- finishing-a-development-branch: Use when implementation is complete, all tests pass, and you need to decide how to integrate the work - guides completion of development work by presenting structured options for merge, PR, or cleanup (file: /Users/gabrielramos/.codex/skills/finishing-a-development-branch/SKILL.md)\n- flowchart-creator: Create HTML flowcharts and process diagrams with decision trees, color-coded stages, arrows, and swimlanes. Use when users request flowcharts, process diagrams, workflow visualizations, or decision trees. (file: /Users/gabrielramos/.codex/skills/flowchart-creator/SKILL.md)\n- git-pushing: Stage, commit, and push git changes with conventional commit messages. Use when user wants to commit and push changes, mentions pushing to remote, or asks to save and push their work. Also activates when user says \"push changes\", \"commit and push\", \"push this\", \"push to github\", or similar git workflow requests. (file: /Users/gabrielramos/.codex/skills/git-pushing/SKILL.md)\n- image-enhancer: Improves the quality of images, especially screenshots, by enhancing resolution, sharpness, and clarity. Perfect for preparing images for presentations, documentation, or social media posts. (file: /Users/gabrielramos/.codex/skills/image-enhancer/SKILL.md)\n- imagen: Generate images using Google Gemini's image generation capabilities. Use this skill when the user needs to create, generate, or produce images for any purpose including UI mockups, icons, illustrations, diagrams, concept art, placeholder images, or visual representations. (file: /Users/gabrielramos/.codex/skills/imagen/SKILL.md)\n- internal-comms: A set of resources to help me write all kinds of internal communications, using the formats that my company likes to use. Claude should use this skill whenever asked to write some sort of internal communications (status reports, leadership updates, 3P updates, company newsletters, FAQs, incident reports, project updates, etc.). (file: /Users/gabrielramos/.codex/skills/internal-comms/SKILL.md)\n- invoice-organizer: Automatically organizes invoices and receipts for tax preparation by reading messy files, extracting key information, renaming them consistently, and sorting them into logical folders. Turns hours of manual bookkeeping into minutes of automated organization. (file: /Users/gabrielramos/.codex/skills/invoice-organizer/SKILL.md)\n- ios-simulator-skill: 21 production-ready scripts for iOS app testing, building, and automation. Provides semantic UI navigation, build automation, accessibility testing, and simulator lifecycle management. Optimized for AI agents with minimal token output. (file: /Users/gabrielramos/.codex/skills/ios-simulator-skill/SKILL.md)\n- kaizen: Use when Code implementation and refactoring, architecturing or designing systems, process and workflow improvements, error handling and validation. Provide tehniquest to avoid over-engineering and apply iterative improvements. (file: /Users/gabrielramos/.codex/skills/kaizen/SKILL.md)\n- lead-research-assistant: Identifies high-quality leads for your product or service by analyzing your business, searching for target companies, and providing actionable contact strategies. Perfect for sales, business development, and marketing professionals. (file: /Users/gabrielramos/.codex/skills/lead-research-assistant/SKILL.md)\n- markdown-to-epub-converter: Convert markdown documents and chat summaries into formatted EPUB ebook files that can be read on any device or uploaded to Kindle. (file: /Users/gabrielramos/.codex/skills/markdown-to-epub/SKILL.md)\n- mcp-builder: Guide for creating high-quality MCP (Model Context Protocol) servers that enable LLMs to interact with external services through well-designed tools. Use when building MCP servers to integrate external APIs or services, whether in Python (FastMCP) or Node/TypeScript (MCP SDK). (file: /Users/gabrielramos/.codex/skills/mcp-builder/SKILL.md)\n- meeting-insights-analyzer: Analyzes meeting transcripts and recordings to uncover behavioral patterns, communication insights, and actionable feedback. Identifies when you avoid conflict, use filler words, dominate conversations, or miss opportunities to listen. Perfect for professionals seeking to improve their communication and leadership skills. (file: /Users/gabrielramos/.codex/skills/meeting-insights-analyzer/SKILL.md)\n- move-code-quality: Analyzes Move language packages against the official Move Book Code Quality Checklist. Use this skill when reviewing Move code, checking Move 2024 Edition compliance, or analyzing Move packages for best practices. Activates automatically when working with .move files or Move.toml manifests. (file: /Users/gabrielramos/.codex/skills/move-code-quality-skill/SKILL.md)\n- n8n-skills: n8n workflow automation knowledge base. Provides n8n node information, node functionality details, workflow patterns, and configuration examples. Covers triggers, data transformation, data input/output, AI integration, covering 10 nodes. Keywords: n8n, workflow, automation, node, trigger, webhook, http request, database, ai agent. (file: /Users/gabrielramos/.codex/skills/n8n-skills/SKILL.md)\n- notebooklm: Use this skill to query your Google NotebookLM notebooks directly from Claude Code for source-grounded, citation-backed answers from Gemini. Browser automation, library management, persistent auth. Drastically reduced hallucinations through document-only responses. (file: /Users/gabrielramos/.codex/skills/notebooklm-skill/SKILL.md)\n- pdf: Comprehensive PDF manipulation toolkit for extracting text and tables, creating new PDFs, merging/splitting documents, and handling forms. When Claude needs to fill in a PDF form or programmatically process, generate, or analyze PDF documents at scale. (file: /Users/gabrielramos/.codex/skills/pdf/SKILL.md)\n- pict-test-designer: Design comprehensive test cases using PICT (Pairwise Independent Combinatorial Testing) for any piece of requirements or code. Analyzes inputs, generates PICT models with parameters, values, and constraints for valid scenarios using pairwise testing. Outputs the PICT model, markdown table of test cases, and expected results. (file: /Users/gabrielramos/.codex/skills/pypict-claude-skill/SKILL.md)\n- playwright-skill: Complete browser automation with Playwright. Auto-detects dev servers, writes clean test scripts to /tmp. Test pages, fill forms, take screenshots, check responsive design, validate UX, test login flows, check links, automate any browser task. Use when user wants to test websites, automate browser interactions, validate web functionality, or perform any browser-based testing. (file: /Users/gabrielramos/.codex/skills/playwright-skill/SKILL.md)\n- postgres: Execute read-only SQL queries against multiple PostgreSQL databases. Use when: (1) querying PostgreSQL databases, (2) exploring database schemas/tables, (3) running SELECT queries for data analysis, (4) checking database contents. Supports multiple database connections with descriptions for intelligent auto-selection. Blocks all write operations (INSERT, UPDATE, DELETE, DROP, etc.) for safety. (file: /Users/gabrielramos/.codex/skills/postgres/SKILL.md)\n- pptx: Presentation creation, editing, and analysis. When Claude needs to work with presentations (.pptx files) for: (1) Creating new presentations, (2) Modifying or editing content, (3) Working with layouts, (4) Adding comments or speaker notes, or any other presentation tasks (file: /Users/gabrielramos/.codex/skills/pptx/SKILL.md)\n- project-bootstrapper: Sets up new projects or improves existing projects with development best practices, tooling, documentation, and workflow automation. Use when user wants to start a new project, improve project structure, add development tooling, or establish professional workflows. (file: /Users/gabrielramos/.codex/skills/project-bootstrapper/SKILL.md)\n- prompt-engineering: Use this skill when you writing commands, hooks, skills for Agent, or prompts for sub agents or any other LLM interaction, including optimizing prompts, improving LLM outputs, or designing production prompt templates. (file: /Users/gabrielramos/.codex/skills/prompt-engineering/SKILL.md)\n- raffle-winner-picker: Picks random winners from lists, spreadsheets, or Google Sheets for giveaways, raffles, and contests. Ensures fair, unbiased selection with transparency. (file: /Users/gabrielramos/.codex/skills/raffle-winner-picker/SKILL.md)\n- review-implementing: Process and implement code review feedback systematically. Use when user provides reviewer comments, PR feedback, code review notes, or asks to implement suggestions from reviews. (file: /Users/gabrielramos/.codex/skills/review-implementing/SKILL.md)\n- ship-learn-next: Transform learning content (like YouTube transcripts, articles, tutorials) into actionable implementation plans using the Ship-Learn-Next framework. Use when user wants to turn advice, lessons, or educational content into concrete action steps, reps, or a learning quest. (file: /Users/gabrielramos/.codex/skills/ship-learn-next/SKILL.md)\n- skill-creator: Guide for creating effective skills. This skill should be used when users want to create a new skill (or update an existing skill) that extends Claude's capabilities with specialized knowledge, workflows, or tool integrations. (file: /Users/gabrielramos/.codex/skills/skill-creator/SKILL.md)\n- skill-installer: Install Codex skills into $CODEX_HOME/skills from a curated list or a GitHub repo path. Use when a user asks to list installable skills, install a curated skill, or install a skill from another repo (including private repos). (file: /Users/gabrielramos/.codex/skills/.system/skill-installer/SKILL.md)\n- skill-share: A skill that creates new Claude skills and automatically shares them on Slack using Rube for seamless team collaboration and skill discovery. (file: /Users/gabrielramos/.codex/skills/skill-share/SKILL.md)\n- slack-gif-creator: Toolkit for creating animated GIFs optimized for Slack, with validators for size constraints and composable animation primitives. This skill applies when users request animated GIFs or emoji animations for Slack from descriptions like \"make me a GIF for Slack of X doing Y\". (file: /Users/gabrielramos/.codex/skills/slack-gif-creator/SKILL.md)\n- software-architecture: Guide for quality focused software architecture. This skill should be used when users want to write code, design architecture, analyze code, in any case that relates to software development. (file: /Users/gabrielramos/.codex/skills/software-architecture/SKILL.md)\n- subagent-driven-development: Use when executing implementation plans with independent tasks in the current session or facing 3+ independent issues that can be investigated without shared state or dependencies - dispatches fresh subagent for each task with code review between tasks, enabling fast iteration with quality gates (file: /Users/gabrielramos/.codex/skills/subagent-driven-development/SKILL.md)\n- tapestry: Unified content extraction and action planning. Use when user says \"tapestry <URL>\", \"weave <URL>\", \"help me plan <URL>\", \"extract and plan <URL>\", \"make this actionable <URL>\", or similar phrases indicating they want to extract content and create an action plan. Automatically detects content type (YouTube video, article, PDF) and processes accordingly. (file: /Users/gabrielramos/.codex/skills/tapestry/SKILL.md)\n- technical-doc-creator: Create HTML technical documentation with code blocks, API workflows, system architecture diagrams, and syntax highlighting. Use when users request technical documentation, API docs, API references, code examples, or developer documentation. (file: /Users/gabrielramos/.codex/skills/technical-doc-creator/SKILL.md)\n- template-skill: Replace with description of the skill and when Claude should use it. (file: /Users/gabrielramos/.codex/skills/template-skill/SKILL.md)\n- terminal-title: Automatically updates terminal window title to reflect the current high-level task. Use at the start of every Claude Code session when the user provides their first prompt, and whenever the user switches to a distinctly new high-level task. Helps developers manage multiple Claude Code terminals by providing clear, at-a-glance identification of what each terminal is working on. (file: /Users/gabrielramos/.codex/skills/claude-code-terminal-title/SKILL.md)\n- test-driven-development: Use when implementing any feature or bugfix, before writing implementation code (file: /Users/gabrielramos/.codex/skills/test-driven-development/SKILL.md)\n- test-fixing: Run tests and systematically fix all failing tests using smart error grouping. Use when user asks to fix failing tests, mentions test failures, runs test suite and failures occur, or requests to make tests pass. (file: /Users/gabrielramos/.codex/skills/test-fixing/SKILL.md)\n- theme-factory: Toolkit for styling artifacts with a theme. These artifacts can be slides, docs, reportings, HTML landing pages, etc. There are 10 pre-set themes with colors/fonts that you can apply to any artifact that has been creating, or can generate a new theme on-the-fly. (file: /Users/gabrielramos/.codex/skills/theme-factory/SKILL.md)\n- timeline-creator: Create HTML timelines and project roadmaps with Gantt charts, milestones, phase groupings, and progress indicators. Use when users request timelines, roadmaps, Gantt charts, project schedules, or milestone visualizations. (file: /Users/gabrielramos/.codex/skills/timeline-creator/SKILL.md)\n- using-git-worktrees: Use when starting feature work that needs isolation from current workspace or before executing implementation plans - creates isolated git worktrees with smart directory selection and safety verification (file: /Users/gabrielramos/.codex/skills/using-git-worktrees/SKILL.md)\n- webapp-testing: Toolkit for interacting with and testing local web applications using Playwright. Supports verifying frontend functionality, debugging UI behavior, capturing browser screenshots, and viewing browser logs. (file: /Users/gabrielramos/.codex/skills/webapp-testing/SKILL.md)\n- xlsx: Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv, etc) for: (1) Creating new spreadsheets with formulas and formatting, (2) Reading or analyzing data, (3) Modify existing spreadsheets while preserving formulas, (4) Data analysis and visualization in spreadsheets, or (5) Recalculating formulas (file: /Users/gabrielramos/.codex/skills/xlsx/SKILL.md)\n- youtube-downloader: Download YouTube videos with customizable quality and format options. Use this skill when the user asks to download, save, or grab YouTube videos. Supports various quality settings (best, 1080p, 720p, 480p, 360p), multiple formats (mp4, webm, mkv), and audio-only downloads as MP3. (file: /Users/gabrielramos/.codex/skills/video-downloader/SKILL.md)\n- youtube-transcript: Download YouTube video transcripts when user provides a YouTube URL or asks to download/get/fetch a transcript from YouTube. Also use when user wants to transcribe or get captions/subtitles from a YouTube video. (file: /Users/gabrielramos/.codex/skills/youtube-transcript/SKILL.md)\n- Discovery: Available skills are listed in project docs and may also appear in a runtime \"## Skills\" section (name + description + file path). These are the sources of truth; skill bodies live on disk at the listed paths.\n- Trigger rules: If the user names a skill (with `$SkillName` or plain text) OR the task clearly matches a skill's description, you must use that skill for that turn. Multiple mentions mean use them all. Do not carry skills across turns unless re-mentioned.\n- Missing/blocked: If a named skill isn't in the list or the path can't be read, say so briefly and continue with the best fallback.\n- How to use a skill (progressive disclosure):\n  1) After deciding to use a skill, open its `SKILL.md`. Read only enough to follow the workflow.\n  2) If `SKILL.md` points to extra folders such as `references/`, load only the specific files needed for the request; don't bulk-load everything.\n  3) If `scripts/` exist, prefer running or patching them instead of retyping large code blocks.\n  4) If `assets/` or templates exist, reuse them instead of recreating from scratch.\n- Description as trigger: The YAML `description` in `SKILL.md` is the primary trigger signal; rely on it to decide applicability. If unsure, ask a brief clarification before proceeding.\n- Coordination and sequencing:\n  - If multiple skills apply, choose the minimal set that covers the request and state the order you'll use them.\n  - Announce which skill(s) you're using and why (one short line). If you skip an obvious skill, say why.\n- Context hygiene:\n  - Keep context small: summarize long sections instead of pasting them; only load extra files when needed.\n  - Avoid deeply nested references; prefer one-hop files explicitly linked from `SKILL.md`.\n  - When variants exist (frameworks, providers, domains), pick only the relevant reference file(s) and note that choice.\n- Safety and fallback: If a skill can't be applied cleanly (missing files, unclear instructions), state the issue, pick the next-best approach, and continue.","source":"cli","model_provider":"openai","git":{"commit_hash":"85c13743c20773773c2d18fd34bb03cb93985418","branch":"main","repository_url":"https://github.com/prof-ramos/sherlock-discord-bot.git"}}}
{"timestamp":"2026-01-05T02:49:42.861Z","type":"response_item","payload":{"type":"message","role":"user","content":[{"type":"input_text","text":"# AGENTS.md instructions for /Users/gabrielramos/sherlock-discord-bot\n\n<INSTRUCTIONS>\n# AGENTS.md\n\nDevelopment guidelines for agentic coding agents working on the SherlockRamosBot Discord chatbot.\n\n## Table of Contents\n\n1. [Project Overview](#project-overview)\n2. [Development Commands](#development-commands)\n3. [Code Style Guidelines](#code-style-guidelines)\n4. [Architecture Guidelines](#architecture-guidelines)\n5. [Development Workflow](#development-workflow)\n6. [Bot Personality Guidelines](#bot-personality-guidelines)\n7. [Security & Permissions](#security--permissions)\n8. [Testing Guidelines](#testing-guidelines-future)\n9. [Performance Considerations](#performance-considerations)\n10. [Deployment Notes](#deployment-notes)\n11. [Extending the Bot](#extending-the-bot)\n\n## Project Overview\n\nSherlockRamosBot is a Python Discord chatbot for Brazilian law students (concurseiros) that uses\nOpenRouter API to provide access to multiple LLM models. The bot maintains contextual conversations\nin Discord threads and is designed for answering legal questions in Portuguese.\n\n## Development Commands\n\n### Running the Bot\n\n```bash\n# Recommended way (uses uv package manager)\nuv run sherlock-bot\n\n# Alternative (direct module execution)\nuv run python -m src.main\n\n# Install dependencies\nuv sync\n```\n\n### Testing\n\n```bash\n# No test framework currently configured\n# When adding tests, use: uv run pytest\n# Run single test: uv run pytest tests/test_file.py::test_function\n```\n\n### Code Quality (TO BE ADDED)\n\n```bash\n# Code formatting (when configured)\nuv run black src/\nuv run ruff format src/\n\n# Linting (when configured)\nuv run ruff check src/\nuv run flake8 src/\n\n# Type checking (when configured)\nuv run pyright src/\n```\n\n## Code Style Guidelines\n\n### Import Organization\n\n**Order**: Standard library ‚Üí Third-party ‚Üí Local imports\n\n```python\n# Standard library\nfrom collections import defaultdict\nfrom typing import Optional, List\nimport os\nimport asyncio\n\n# Third-party\nimport discord\nfrom discord import Message as DiscordMessage, app_commands\nimport yaml\nimport dacite\n\n# Local imports\nfrom src.base import Message, Conversation, ThreadConfig\nfrom src.constants import BOT_NAME, DEFAULT_MODEL\nfrom src.utils import logger, should_block\n```\n\n### Type Hints Requirements\n\n- **Mandatory**: All functions must have type hints for parameters and return values\n- **Use Optional** for nullable values: `Optional[str]`\n- **Use Literal** for string constants: `Literal[\"openai/gpt-3.5-turbo\", \"anthropic/claude-3-opus\"]`\n- **Use Final** for constants: `Final[str]`, `Final[List[int]]`\n- **Prefer specific types** over generics when possible\n\n### Naming Conventions\n\n- **Variables/Functions**: `snake_case`\n- **Classes/Enums**: `PascalCase`\n- **Constants**: `UPPER_CASE_WITH_UNDERSCORES`\n- **Descriptive names**: `discord_message_to_message` (not `convert_msg`)\n- **Consistent prefixes**: `BOT_`, `SERVER_TO_`, `MY_BOT_`\n\n### Error Handling Patterns\n\n```python\n# Use custom exception hierarchy from src.exceptions\nfrom src.exceptions import SherlockBotError, ConfigError, OpenRouterError\n\n# Structured error handling with specific catches\ntry:\n    result = await some_operation()\nexcept OpenRouterError as e:\n    logger.exception(\"OpenRouter API error\")\n    await send_error_message(ctx, f\"API Error: {e}\")\nexcept ConfigError as e:\n    logger.exception(\"Configuration error\")\n    await send_error_message(ctx, f\"Configuration Error: {e}\")\nexcept Exception as e:\n    logger.exception(\"Unexpected error\")\n    await send_error_message(ctx, \"An unexpected error occurred\")\n```\n\n### Async/Await Patterns\n\n- **All Discord operations must be async**\n- **Use proper async context managers**: `async with thread.typing():`\n- **Chain async calls properly**: `result = await func1(await func2())`\n- **Handle async errors with try/except blocks**\n\n### Discord.py Specific Patterns\n\n```python\n# Type aliases for Discord objects\nfrom discord import Message as DiscordMessage, Guild as DiscordGuild\n\n# Command decorators with permission checks\n@tree.command(\n    name=\"chat\",\n    description=\"Inicia uma conversa com o bot\",\n    guild=discord.Object(id=guild_id)\n)\n@app_commands.describe(message=\"Sua pergunta ou d√∫vida\")\nasync def chat_command(\n    interaction: discord.Interaction,\n    message: str,\n    temperature: Optional[float] = 1.0\n) -> None:\n    # Implementation\n```\n\n### Data Structures\n\n```python\n# Use dataclasses for structured data\n@dataclass(frozen=True)\nclass Message:\n    user: str\n    text: Optional[str] = None\n\n# Use enums for status codes and constants\nclass CompletionResult(Enum):\n    SUCCESS = \"success\"\n    TOO_LONG = \"too_long\"\n    INVALID_REQUEST = \"invalid_request\"\n    OTHER_ERROR = \"other_error\"\n```\n\n### Configuration Management\n\n- **Environment variables**: Use `get_env()` from `src.constants`\n- **YAML config**: Bot personality in `src/config.yaml`\n- **Type-safe config**: Use dacite with dataclasses for YAML parsing\n- **Validation**: Raise `ConfigError` for missing required variables\n\n### Logging Patterns\n\n```python\n# Use logger from src.utils\nfrom src.utils import logger\n\n# Structured logging with context\nlogger.info(\"Processing message\", extra={\n    \"user_id\": interaction.user.id,\n    \"channel_id\": interaction.channel.id,\n    \"message_length\": len(message)\n})\n\n# Exception logging with full traceback\nlogger.exception(\"Error processing completion\")\n```\n\n### Documentation Standards\n\n- **Docstrings**: All public functions must have docstrings\n- **Type hints**: Serve as documentation - make them descriptive\n- **Inline comments**: Use for complex logic, especially Portuguese legal concepts\n- **TODO markers**: Use for future improvements with specific context\n\n### File Organization\n\n```\nsrc/\n‚îú‚îÄ‚îÄ main.py          # Entry point, Discord events, slash commands\n‚îú‚îÄ‚îÄ base.py          # Core data structures (Message, Conversation, etc.)\n‚îú‚îÄ‚îÄ completion.py    # LLM API interaction and response handling\n‚îú‚îÄ‚îÄ constants.py     # Configuration loading, environment variables\n‚îú‚îÄ‚îÄ utils.py         # Helper utilities, Discord operations\n‚îú‚îÄ‚îÄ moderation.py    # Content moderation (currently disabled)\n‚îú‚îÄ‚îÄ exceptions.py    # Custom exception hierarchy\n‚îî‚îÄ‚îÄ config.yaml      # Bot personality and example conversations\n```\n\n## Architecture Guidelines\n\n### Thread-Based Conversations\n\n- **Create threads** for each conversation via `/chat` command\n- **Maintain context** using `thread_data` defaultdict with `ThreadConfig`\n- **Message limits**: Respect `MAX_THREAD_MESSAGES` (200) and token limits\n- **Thread lifecycle**: Use `ACTIVATE_THREAD_PREFIX` (üí¨‚úÖ) and `INACTIVATE_THREAD_PREFIX` (üí¨‚ùå)\n\n### OpenRouter Integration\n\n- **Base URL**: Must be `https://openrouter.ai/api/v1`\n- **API key format**: `sk-or-v1-...`\n- **Custom headers**: Required `HTTP-Referer` and `X-Title`\n- **Model selection**: Use `AVAILABLE_MODELS` literal type for type safety\n\n### Error Recovery\n\n- **Graceful degradation**: Always provide user-friendly error messages\n- **Thread state**: Don't leave threads in broken state\n- **Retry logic**: Implement for transient API errors\n- **Logging**: Log all errors with context for debugging\n\n## Development Workflow\n\n### Environment Setup\n\n1. Copy `.env.example` to `.env` and configure variables\n2. Run `uv sync` to install dependencies\n3. Ensure Python 3.13+ is installed\n4. Configure Discord bot with proper intents (Message Content Intent required)\n\n### Making Changes\n\n1. **Understand existing patterns** before modifying code\n2. **Follow type hints** and error handling patterns\n3. **Test Discord interactions** carefully (threads, permissions)\n4. **Update configuration** if adding new models or features\n5. **Log changes** appropriately for debugging\n\n### Common Pitfalls\n\n- **Missing Message Content Intent**: Bot won't receive message content\n- **Thread state loss on restart**: `thread_data` is in-memory only\n- **OpenRouter headers**: Required for API requests\n- **Server allowlist**: Only `ALLOWED_SERVER_IDS` can use bot\n- **Async context**: All Discord operations must be async\n\n## Bot Personality Guidelines\n\n### Legal Focus\n\n- **Brazilian law**: Specialize in Brazilian legal topics\n- **Concurseiros**: Target audience studying for public exams\n- **Portuguese language**: All responses in Portuguese\n- **Professional tone**: Maintain helpful, educational tone\n\n### Response Patterns\n\n- **Structured answers**: Use clear organization for legal concepts\n- **Examples provided**: Include practical examples when helpful\n- **Citations**: Reference laws, articles, and jurisprudence when applicable\n- **Study focus**: Emphasize exam-relevant information\n\n## Security & Permissions\n\n### Required Discord Permissions\n\n- Send Messages\n- Send Messages in Threads\n- Create Public Threads\n- Manage Messages (moderation)\n- Manage Threads\n- Read Message History\n- Use Slash Commands\n\n### Security Considerations\n\n- **Server allowlist**: Enforce `ALLOWED_SERVER_IDS`\n- **API key security**: Never commit API keys to repository\n- **Input validation**: Validate user inputs appropriately\n- **Rate limiting**: Respect API rate limits\n\n## Testing Guidelines (Future)\n\n### When Adding Tests\n\n- **Use pytest**: Framework of choice for Python testing\n- **Mock Discord**: Use pytest-discord or similar for Discord.py testing\n- **Test async functions**: Use pytest-asyncio for async test functions\n- **Configuration testing**: Test config loading and validation\n- **Error scenarios**: Test error handling and recovery\n\n### Test Structure\n\n```\ntests/\n‚îú‚îÄ‚îÄ test_main.py           # Discord event handlers\n‚îú‚îÄ‚îÄ test_completion.py     # OpenRouter API integration\n‚îú‚îÄ‚îÄ test_base.py          # Data structures\n‚îú‚îÄ‚îÄ test_constants.py     # Configuration loading\n‚îú‚îÄ‚îÄ test_utils.py         # Helper utilities\n‚îî‚îÄ‚îÄ conftest.py           # Test fixtures and configuration\n```\n\n## Performance Considerations\n\n### Memory Management\n\n- **Thread limits**: Respect `MAX_THREAD_MESSAGES` to prevent memory bloat\n- **Generator patterns**: Use generators for large data processing\n- **Context cleanup**: Clean up thread data when threads close\n\n### API Optimization\n\n- **Batch operations**: Batch Discord operations when possible\n- **Caching**: Cache frequently accessed configuration\n- **Rate limiting**: Implement appropriate rate limiting for API calls\n\n## Deployment Notes\n\n### Environment Variables\n\n- **Required**: `OPENROUTER_API_KEY`, `DISCORD_BOT_TOKEN`, `DISCORD_CLIENT_ID`\n- **Optional**: `ALLOWED_SERVER_IDS`, `SERVER_TO_MODERATION_CHANNEL`, `DEFAULT_MODEL`\n- **Validation**: Use `get_env()` with `required=True` for critical variables\n\n### Production Considerations\n\n- **Logging**: Configure appropriate log levels for production\n- **Error monitoring**: Consider adding error monitoring service\n- **Resource limits**: Monitor memory and API usage\n- **Backup strategy**: Thread state is lost on restart\n\n## Extending the Bot\n\n### Adding a New Slash Command\n\nTo add a new slash command, define it in `src/main.py`:\n\n```python\n@tree.command(\n    name=\"jurisprudencia\",\n    description=\"Busca jurisprud√™ncia no banco de dados\",\n    guild=discord.Object(id=guild_id)\n)\n@app_commands.describe(termo=\"Termo para busca\")\nasync def jurisprudencia_command(interaction: discord.Interaction, termo: str):\n    await interaction.response.defer()\n    # L√≥gica de busca...\n    results = await search_jurisprudence(termo)\n    await interaction.followup.send(f\"Resultados para {termo}: ...\")\n```\n\n### Adding a New RAG Source\n\nTo ingest a new type of document, create a handler in `scripts/ingest_docs.py`:\n\n```python\ndef extract_text_from_html(file_path: Path) -> str:\n    # Use BeautifulSoup or similar\n    ...\n```\n\n\n## Skills\nThese skills are discovered at startup from multiple local sources. Each entry includes a name, description, and file path so you can open the source for full instructions.\n- architecture-diagram-creator: Create comprehensive HTML architecture diagrams showing data flows, business objectives, features, technical architecture, and deployment. Use when users request system architecture, project documentation, high-level overviews, or technical specifications. (file: /Users/gabrielramos/.codex/skills/architecture-diagram-creator/SKILL.md)\n- article-extractor: Extract clean article content from URLs (blog posts, articles, tutorials) and save as readable text. Use when user wants to download, extract, or save an article/blog post from a URL without ads, navigation, or clutter. (file: /Users/gabrielramos/.codex/skills/article-extractor/SKILL.md)\n- artifacts-builder: Suite of tools for creating elaborate, multi-component claude.ai HTML artifacts using modern frontend web technologies (React, Tailwind CSS, shadcn/ui). Use for complex artifacts requiring state management, routing, or shadcn/ui components - not for simple single-file HTML/JSX artifacts. (file: /Users/gabrielramos/.codex/skills/artifacts-builder/SKILL.md)\n- aws-agentic-ai: AWS Bedrock AgentCore comprehensive expert for deploying and managing all AgentCore services. Use when working with Gateway, Runtime, Memory, Identity, or any AgentCore component. Covers MCP target deployment, credential management, schema optimization, runtime configuration, memory management, and identity services. (file: /Users/gabrielramos/.codex/skills/aws-agentic-ai/SKILL.md)\n- aws-cdk-development: AWS Cloud Development Kit (CDK) expert for building cloud infrastructure with TypeScript/Python. Use when creating CDK stacks, defining CDK constructs, implementing infrastructure as code, or when the user mentions CDK, CloudFormation, IaC, cdk synth, cdk deploy, or wants to define AWS infrastructure programmatically. Covers CDK app structure, construct patterns, stack composition, and deployment workflows. (file: /Users/gabrielramos/.codex/skills/aws-cdk-development/SKILL.md)\n- aws-cost-operations: This skill provides AWS cost optimization, monitoring, and operational best practices with integrated MCP servers for billing analysis, cost estimation, observability, and security assessment. (file: /Users/gabrielramos/.codex/skills/aws-cost-operations/SKILL.md)\n- aws-serverless-eda: AWS serverless and event-driven architecture expert based on Well-Architected Framework. Use when building serverless APIs, Lambda functions, REST APIs, microservices, or async workflows. Covers Lambda with TypeScript/Python, API Gateway (REST/HTTP), DynamoDB, Step Functions, EventBridge, SQS, SNS, and serverless patterns. Essential when user mentions serverless, Lambda, API Gateway, event-driven, async processing, queues, pub/sub, or wants to build scalable serverless applications with AWS best practices. (file: /Users/gabrielramos/.codex/skills/aws-serverless-eda/SKILL.md)\n- brainstorming: You MUST use this before any creative work - creating features, building components, adding functionality, or modifying behavior. Explores user intent, requirements and design before implementation. (file: /Users/gabrielramos/.codex/skills/brainstorming/SKILL.md)\n- brand-guidelines: Applies Anthropic's official brand colors and typography to any sort of artifact that may benefit from having Anthropic's look-and-feel. Use it when brand colors or style guidelines, visual formatting, or company design standards apply. (file: /Users/gabrielramos/.codex/skills/brand-guidelines/SKILL.md)\n- canvas-design: Create beautiful visual art in .png and .pdf documents using design philosophy. You should use this skill when the user asks to create a poster, piece of art, design, or other static piece. Create original visual designs, never copying existing artists' work to avoid copyright violations. (file: /Users/gabrielramos/.codex/skills/canvas-design/SKILL.md)\n- changelog-generator: Automatically creates user-facing changelogs from git commits by analyzing commit history, categorizing changes, and transforming technical commits into clear, customer-friendly release notes. Turns hours of manual changelog writing into minutes of automated generation. (file: /Users/gabrielramos/.codex/skills/changelog-generator/SKILL.md)\n- code-auditor: Performs comprehensive codebase analysis covering architecture, code quality, security, performance, testing, and maintainability. Use when user wants to audit code quality, identify technical debt, find security issues, assess test coverage, or get a codebase health check. (file: /Users/gabrielramos/.codex/skills/code-auditor/SKILL.md)\n- code-execution: Execute Python code locally with marketplace API access for 90%+ token savings on bulk operations. Activates when user requests bulk operations (10+ files), complex multi-step workflows, iterative processing, or mentions efficiency/performance. (file: /Users/gabrielramos/.codex/skills/code-execution/SKILL.md)\n- code-refactor: Perform bulk code refactoring operations like renaming variables/functions across files, replacing patterns, and updating API calls. Use when users request renaming identifiers, replacing deprecated code patterns, updating method calls, or making consistent changes across multiple locations. (file: /Users/gabrielramos/.codex/skills/code-refactor/SKILL.md)\n- code-transfer: Transfer code between files with line-based precision. Use when users request copying code from one location to another, moving functions or classes between files, extracting code blocks, or inserting code at specific line numbers. (file: /Users/gabrielramos/.codex/skills/code-transfer/SKILL.md)\n- codebase-documenter: Generates comprehensive documentation explaining how a codebase works, including architecture, key components, data flow, and development guidelines. Use when user wants to understand unfamiliar code, create onboarding docs, document architecture, or explain how the system works. (file: /Users/gabrielramos/.codex/skills/codebase-documenter/SKILL.md)\n- competitive-ads-extractor: Extracts and analyzes competitors' ads from ad libraries (Facebook, LinkedIn, etc.) to understand what messaging, problems, and creative approaches are working. Helps inspire and improve your own ad campaigns. (file: /Users/gabrielramos/.codex/skills/competitive-ads-extractor/SKILL.md)\n- content-research-writer: Assists in writing high-quality content by conducting research, adding citations, improving hooks, iterating on outlines, and providing real-time feedback on each section. Transforms your writing process from solo effort to collaborative partnership. (file: /Users/gabrielramos/.codex/skills/content-research-writer/SKILL.md)\n- conversation-analyzer: Analyzes your Claude Code conversation history to identify patterns, common mistakes, and opportunities for workflow improvement. Use when user wants to understand usage patterns, optimize workflow, identify automation opportunities, or check if they're following best practices. (file: /Users/gabrielramos/.codex/skills/conversation-analyzer/SKILL.md)\n- csv-data-summarizer: Analyzes CSV files, generates summary stats, and plots quick visualizations using Python and pandas. (file: /Users/gabrielramos/.codex/skills/csv-data-summarizer-claude-skill/SKILL.md)\n- d3-viz: Creating interactive data visualisations using d3.js. This skill should be used when creating custom charts, graphs, network diagrams, geographic visualisations, or any complex SVG-based data visualisation that requires fine-grained control over visual elements, transitions, or interactions. Use this for bespoke visualisations beyond standard charting libraries, whether in React, Vue, Svelte, vanilla JavaScript, or any other environment. (file: /Users/gabrielramos/.codex/skills/claude-d3js-skill/SKILL.md)\n- dashboard-creator: Create HTML dashboards with KPI metric cards, bar/pie/line charts, progress indicators, and data visualizations. Use when users request dashboards, metrics displays, KPI visualizations, data charts, or monitoring interfaces. (file: /Users/gabrielramos/.codex/skills/dashboard-creator/SKILL.md)\n- developer-growth-analysis: Analyzes your recent Claude Code chat history to identify coding patterns, development gaps, and areas for improvement, curates relevant learning resources from HackerNews, and automatically sends a personalized growth report to your Slack DMs. (file: /Users/gabrielramos/.codex/skills/developer-growth-analysis/SKILL.md)\n- docx: Comprehensive document creation, editing, and analysis with support for tracked changes, comments, formatting preservation, and text extraction. When Claude needs to work with professional documents (.docx files) for: (1) Creating new documents, (2) Modifying or editing content, (3) Working with tracked changes, (4) Adding comments, or any other document tasks (file: /Users/gabrielramos/.codex/skills/docx/SKILL.md)\n- domain-name-brainstormer: Generates creative domain name ideas for your project and checks availability across multiple TLDs (.com, .io, .dev, .ai, etc.). Saves hours of brainstorming and manual checking. (file: /Users/gabrielramos/.codex/skills/domain-name-brainstormer/SKILL.md)\n- family-history-planning: Provides assistance with planning family history and genealogy research projects. (file: /Users/gabrielramos/.codex/skills/claude-family-history-research-skill/SKILL.md)\n- feature-planning: Break down feature requests into detailed, implementable plans with clear tasks. Use when user requests a new feature, enhancement, or complex change. (file: /Users/gabrielramos/.codex/skills/feature-planning/SKILL.md)\n- ffuf-web-fuzzing: Expert guidance for ffuf web fuzzing during penetration testing, including authenticated fuzzing with raw requests, auto-calibration, and result analysis (file: /Users/gabrielramos/.codex/skills/ffuf-skill/SKILL.md)\n- file-operations: Analyze files and get detailed metadata including size, line counts, modification times, and content statistics. Use when users request file information, statistics, or analysis without modifying files. (file: /Users/gabrielramos/.codex/skills/file-operations/SKILL.md)\n- file-organizer: Intelligently organizes your files and folders across your computer by understanding context, finding duplicates, suggesting better structures, and automating cleanup tasks. Reduces cognitive load and keeps your digital workspace tidy without manual effort. (file: /Users/gabrielramos/.codex/skills/file-organizer/SKILL.md)\n- finishing-a-development-branch: Use when implementation is complete, all tests pass, and you need to decide how to integrate the work - guides completion of development work by presenting structured options for merge, PR, or cleanup (file: /Users/gabrielramos/.codex/skills/finishing-a-development-branch/SKILL.md)\n- flowchart-creator: Create HTML flowcharts and process diagrams with decision trees, color-coded stages, arrows, and swimlanes. Use when users request flowcharts, process diagrams, workflow visualizations, or decision trees. (file: /Users/gabrielramos/.codex/skills/flowchart-creator/SKILL.md)\n- git-pushing: Stage, commit, and push git changes with conventional commit messages. Use when user wants to commit and push changes, mentions pushing to remote, or asks to save and push their work. Also activates when user says \"push changes\", \"commit and push\", \"push this\", \"push to github\", or similar git workflow requests. (file: /Users/gabrielramos/.codex/skills/git-pushing/SKILL.md)\n- image-enhancer: Improves the quality of images, especially screenshots, by enhancing resolution, sharpness, and clarity. Perfect for preparing images for presentations, documentation, or social media posts. (file: /Users/gabrielramos/.codex/skills/image-enhancer/SKILL.md)\n- imagen: Generate images using Google Gemini's image generation capabilities. Use this skill when the user needs to create, generate, or produce images for any purpose including UI mockups, icons, illustrations, diagrams, concept art, placeholder images, or visual representations. (file: /Users/gabrielramos/.codex/skills/imagen/SKILL.md)\n- internal-comms: A set of resources to help me write all kinds of internal communications, using the formats that my company likes to use. Claude should use this skill whenever asked to write some sort of internal communications (status reports, leadership updates, 3P updates, company newsletters, FAQs, incident reports, project updates, etc.). (file: /Users/gabrielramos/.codex/skills/internal-comms/SKILL.md)\n- invoice-organizer: Automatically organizes invoices and receipts for tax preparation by reading messy files, extracting key information, renaming them consistently, and sorting them into logical folders. Turns hours of manual bookkeeping into minutes of automated organization. (file: /Users/gabrielramos/.codex/skills/invoice-organizer/SKILL.md)\n- ios-simulator-skill: 21 production-ready scripts for iOS app testing, building, and automation. Provides semantic UI navigation, build automation, accessibility testing, and simulator lifecycle management. Optimized for AI agents with minimal token output. (file: /Users/gabrielramos/.codex/skills/ios-simulator-skill/SKILL.md)\n- kaizen: Use when Code implementation and refactoring, architecturing or designing systems, process and workflow improvements, error handling and validation. Provide tehniquest to avoid over-engineering and apply iterative improvements. (file: /Users/gabrielramos/.codex/skills/kaizen/SKILL.md)\n- lead-research-assistant: Identifies high-quality leads for your product or service by analyzing your business, searching for target companies, and providing actionable contact strategies. Perfect for sales, business development, and marketing professionals. (file: /Users/gabrielramos/.codex/skills/lead-research-assistant/SKILL.md)\n- markdown-to-epub-converter: Convert markdown documents and chat summaries into formatted EPUB ebook files that can be read on any device or uploaded to Kindle. (file: /Users/gabrielramos/.codex/skills/markdown-to-epub/SKILL.md)\n- mcp-builder: Guide for creating high-quality MCP (Model Context Protocol) servers that enable LLMs to interact with external services through well-designed tools. Use when building MCP servers to integrate external APIs or services, whether in Python (FastMCP) or Node/TypeScript (MCP SDK). (file: /Users/gabrielramos/.codex/skills/mcp-builder/SKILL.md)\n- meeting-insights-analyzer: Analyzes meeting transcripts and recordings to uncover behavioral patterns, communication insights, and actionable feedback. Identifies when you avoid conflict, use filler words, dominate conversations, or miss opportunities to listen. Perfect for professionals seeking to improve their communication and leadership skills. (file: /Users/gabrielramos/.codex/skills/meeting-insights-analyzer/SKILL.md)\n- move-code-quality: Analyzes Move language packages against the official Move Book Code Quality Checklist. Use this skill when reviewing Move code, checking Move 2024 Edition compliance, or analyzing Move packages for best practices. Activates automatically when working with .move files or Move.toml manifests. (file: /Users/gabrielramos/.codex/skills/move-code-quality-skill/SKILL.md)\n- n8n-skills: n8n workflow automation knowledge base. Provides n8n node information, node functionality details, workflow patterns, and configuration examples. Covers triggers, data transformation, data input/output, AI integration, covering 10 nodes. Keywords: n8n, workflow, automation, node, trigger, webhook, http request, database, ai agent. (file: /Users/gabrielramos/.codex/skills/n8n-skills/SKILL.md)\n- notebooklm: Use this skill to query your Google NotebookLM notebooks directly from Claude Code for source-grounded, citation-backed answers from Gemini. Browser automation, library management, persistent auth. Drastically reduced hallucinations through document-only responses. (file: /Users/gabrielramos/.codex/skills/notebooklm-skill/SKILL.md)\n- pdf: Comprehensive PDF manipulation toolkit for extracting text and tables, creating new PDFs, merging/splitting documents, and handling forms. When Claude needs to fill in a PDF form or programmatically process, generate, or analyze PDF documents at scale. (file: /Users/gabrielramos/.codex/skills/pdf/SKILL.md)\n- pict-test-designer: Design comprehensive test cases using PICT (Pairwise Independent Combinatorial Testing) for any piece of requirements or code. Analyzes inputs, generates PICT models with parameters, values, and constraints for valid scenarios using pairwise testing. Outputs the PICT model, markdown table of test cases, and expected results. (file: /Users/gabrielramos/.codex/skills/pypict-claude-skill/SKILL.md)\n- playwright-skill: Complete browser automation with Playwright. Auto-detects dev servers, writes clean test scripts to /tmp. Test pages, fill forms, take screenshots, check responsive design, validate UX, test login flows, check links, automate any browser task. Use when user wants to test websites, automate browser interactions, validate web functionality, or perform any browser-based testing. (file: /Users/gabrielramos/.codex/skills/playwright-skill/SKILL.md)\n- postgres: Execute read-only SQL queries against multiple PostgreSQL databases. Use when: (1) querying PostgreSQL databases, (2) exploring database schemas/tables, (3) running SELECT queries for data analysis, (4) checking database contents. Supports multiple database connections with descriptions for intelligent auto-selection. Blocks all write operations (INSERT, UPDATE, DELETE, DROP, etc.) for safety. (file: /Users/gabrielramos/.codex/skills/postgres/SKILL.md)\n- pptx: Presentation creation, editing, and analysis. When Claude needs to work with presentations (.pptx files) for: (1) Creating new presentations, (2) Modifying or editing content, (3) Working with layouts, (4) Adding comments or speaker notes, or any other presentation tasks (file: /Users/gabrielramos/.codex/skills/pptx/SKILL.md)\n- project-bootstrapper: Sets up new projects or improves existing projects with development best practices, tooling, documentation, and workflow automation. Use when user wants to start a new project, improve project structure, add development tooling, or establish professional workflows. (file: /Users/gabrielramos/.codex/skills/project-bootstrapper/SKILL.md)\n- prompt-engineering: Use this skill when you writing commands, hooks, skills for Agent, or prompts for sub agents or any other LLM interaction, including optimizing prompts, improving LLM outputs, or designing production prompt templates. (file: /Users/gabrielramos/.codex/skills/prompt-engineering/SKILL.md)\n- raffle-winner-picker: Picks random winners from lists, spreadsheets, or Google Sheets for giveaways, raffles, and contests. Ensures fair, unbiased selection with transparency. (file: /Users/gabrielramos/.codex/skills/raffle-winner-picker/SKILL.md)\n- review-implementing: Process and implement code review feedback systematically. Use when user provides reviewer comments, PR feedback, code review notes, or asks to implement suggestions from reviews. (file: /Users/gabrielramos/.codex/skills/review-implementing/SKILL.md)\n- ship-learn-next: Transform learning content (like YouTube transcripts, articles, tutorials) into actionable implementation plans using the Ship-Learn-Next framework. Use when user wants to turn advice, lessons, or educational content into concrete action steps, reps, or a learning quest. (file: /Users/gabrielramos/.codex/skills/ship-learn-next/SKILL.md)\n- skill-creator: Guide for creating effective skills. This skill should be used when users want to create a new skill (or update an existing skill) that extends Claude's capabilities with specialized knowledge, workflows, or tool integrations. (file: /Users/gabrielramos/.codex/skills/skill-creator/SKILL.md)\n- skill-installer: Install Codex skills into $CODEX_HOME/skills from a curated list or a GitHub repo path. Use when a user asks to list installable skills, install a curated skill, or install a skill from another repo (including private repos). (file: /Users/gabrielramos/.codex/skills/.system/skill-installer/SKILL.md)\n- skill-share: A skill that creates new Claude skills and automatically shares them on Slack using Rube for seamless team collaboration and skill discovery. (file: /Users/gabrielramos/.codex/skills/skill-share/SKILL.md)\n- slack-gif-creator: Toolkit for creating animated GIFs optimized for Slack, with validators for size constraints and composable animation primitives. This skill applies when users request animated GIFs or emoji animations for Slack from descriptions like \"make me a GIF for Slack of X doing Y\". (file: /Users/gabrielramos/.codex/skills/slack-gif-creator/SKILL.md)\n- software-architecture: Guide for quality focused software architecture. This skill should be used when users want to write code, design architecture, analyze code, in any case that relates to software development. (file: /Users/gabrielramos/.codex/skills/software-architecture/SKILL.md)\n- subagent-driven-development: Use when executing implementation plans with independent tasks in the current session or facing 3+ independent issues that can be investigated without shared state or dependencies - dispatches fresh subagent for each task with code review between tasks, enabling fast iteration with quality gates (file: /Users/gabrielramos/.codex/skills/subagent-driven-development/SKILL.md)\n- tapestry: Unified content extraction and action planning. Use when user says \"tapestry <URL>\", \"weave <URL>\", \"help me plan <URL>\", \"extract and plan <URL>\", \"make this actionable <URL>\", or similar phrases indicating they want to extract content and create an action plan. Automatically detects content type (YouTube video, article, PDF) and processes accordingly. (file: /Users/gabrielramos/.codex/skills/tapestry/SKILL.md)\n- technical-doc-creator: Create HTML technical documentation with code blocks, API workflows, system architecture diagrams, and syntax highlighting. Use when users request technical documentation, API docs, API references, code examples, or developer documentation. (file: /Users/gabrielramos/.codex/skills/technical-doc-creator/SKILL.md)\n- template-skill: Replace with description of the skill and when Claude should use it. (file: /Users/gabrielramos/.codex/skills/template-skill/SKILL.md)\n- terminal-title: Automatically updates terminal window title to reflect the current high-level task. Use at the start of every Claude Code session when the user provides their first prompt, and whenever the user switches to a distinctly new high-level task. Helps developers manage multiple Claude Code terminals by providing clear, at-a-glance identification of what each terminal is working on. (file: /Users/gabrielramos/.codex/skills/claude-code-terminal-title/SKILL.md)\n- test-driven-development: Use when implementing any feature or bugfix, before writing implementation code (file: /Users/gabrielramos/.codex/skills/test-driven-development/SKILL.md)\n- test-fixing: Run tests and systematically fix all failing tests using smart error grouping. Use when user asks to fix failing tests, mentions test failures, runs test suite and failures occur, or requests to make tests pass. (file: /Users/gabrielramos/.codex/skills/test-fixing/SKILL.md)\n- theme-factory: Toolkit for styling artifacts with a theme. These artifacts can be slides, docs, reportings, HTML landing pages, etc. There are 10 pre-set themes with colors/fonts that you can apply to any artifact that has been creating, or can generate a new theme on-the-fly. (file: /Users/gabrielramos/.codex/skills/theme-factory/SKILL.md)\n- timeline-creator: Create HTML timelines and project roadmaps with Gantt charts, milestones, phase groupings, and progress indicators. Use when users request timelines, roadmaps, Gantt charts, project schedules, or milestone visualizations. (file: /Users/gabrielramos/.codex/skills/timeline-creator/SKILL.md)\n- using-git-worktrees: Use when starting feature work that needs isolation from current workspace or before executing implementation plans - creates isolated git worktrees with smart directory selection and safety verification (file: /Users/gabrielramos/.codex/skills/using-git-worktrees/SKILL.md)\n- webapp-testing: Toolkit for interacting with and testing local web applications using Playwright. Supports verifying frontend functionality, debugging UI behavior, capturing browser screenshots, and viewing browser logs. (file: /Users/gabrielramos/.codex/skills/webapp-testing/SKILL.md)\n- xlsx: Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv, etc) for: (1) Creating new spreadsheets with formulas and formatting, (2) Reading or analyzing data, (3) Modify existing spreadsheets while preserving formulas, (4) Data analysis and visualization in spreadsheets, or (5) Recalculating formulas (file: /Users/gabrielramos/.codex/skills/xlsx/SKILL.md)\n- youtube-downloader: Download YouTube videos with customizable quality and format options. Use this skill when the user asks to download, save, or grab YouTube videos. Supports various quality settings (best, 1080p, 720p, 480p, 360p), multiple formats (mp4, webm, mkv), and audio-only downloads as MP3. (file: /Users/gabrielramos/.codex/skills/video-downloader/SKILL.md)\n- youtube-transcript: Download YouTube video transcripts when user provides a YouTube URL or asks to download/get/fetch a transcript from YouTube. Also use when user wants to transcribe or get captions/subtitles from a YouTube video. (file: /Users/gabrielramos/.codex/skills/youtube-transcript/SKILL.md)\n- Discovery: Available skills are listed in project docs and may also appear in a runtime \"## Skills\" section (name + description + file path). These are the sources of truth; skill bodies live on disk at the listed paths.\n- Trigger rules: If the user names a skill (with `$SkillName` or plain text) OR the task clearly matches a skill's description, you must use that skill for that turn. Multiple mentions mean use them all. Do not carry skills across turns unless re-mentioned.\n- Missing/blocked: If a named skill isn't in the list or the path can't be read, say so briefly and continue with the best fallback.\n- How to use a skill (progressive disclosure):\n  1) After deciding to use a skill, open its `SKILL.md`. Read only enough to follow the workflow.\n  2) If `SKILL.md` points to extra folders such as `references/`, load only the specific files needed for the request; don't bulk-load everything.\n  3) If `scripts/` exist, prefer running or patching them instead of retyping large code blocks.\n  4) If `assets/` or templates exist, reuse them instead of recreating from scratch.\n- Description as trigger: The YAML `description` in `SKILL.md` is the primary trigger signal; rely on it to decide applicability. If unsure, ask a brief clarification before proceeding.\n- Coordination and sequencing:\n  - If multiple skills apply, choose the minimal set that covers the request and state the order you'll use them.\n  - Announce which skill(s) you're using and why (one short line). If you skip an obvious skill, say why.\n- Context hygiene:\n  - Keep context small: summarize long sections instead of pasting them; only load extra files when needed.\n  - Avoid deeply nested references; prefer one-hop files explicitly linked from `SKILL.md`.\n  - When variants exist (frameworks, providers, domains), pick only the relevant reference file(s) and note that choice.\n- Safety and fallback: If a skill can't be applied cleanly (missing files, unclear instructions), state the issue, pick the next-best approach, and continue.\n</INSTRUCTIONS>"}]}}
{"timestamp":"2026-01-05T02:49:42.861Z","type":"response_item","payload":{"type":"message","role":"user","content":[{"type":"input_text","text":"<environment_context>\n  <cwd>/Users/gabrielramos/sherlock-discord-bot</cwd>\n  <approval_policy>on-request</approval_policy>\n  <sandbox_mode>workspace-write</sandbox_mode>\n  <network_access>restricted</network_access>\n  <shell>zsh</shell>\n</environment_context>"}]}}
